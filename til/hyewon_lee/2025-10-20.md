## ✨ 10월 20일 (금)

### 🍅 KPT 자기 회고

#### 💪 **Keep (계속할 점)**

- **잘된 점**:
  - 프로젝트에 정말 필요한 핵심 문서(요구사항 정의서, 프로그램 명세서, API 명세서)를 구분할 수 있게 되었음.
  - 각 문서가 누구의 관점에서(고객, 설계자, 개발자) 작성되어야 하는지 명확히 이해했음.
  - 현재 기획 중인 아이디어(모모코(인형극))의 '목적성'과 '임팩트' 측면에서 한계점을 파악했음.
- **유지하고 싶은 방식**:
  - 문서 작성 시, 프로젝트 규모와 효율을 고려하여(Ex. ERD) 과감하게 생략할 것은 생략하되, 그 이유를 명확히 하는 접근 방식을 고려하고 싶음.
  - 아이디어 기획 단계에서 "이 서비스의 핵심 목적이 무엇인가?"를 끊임없이 질문하여 방향성을 명확하게 잡는 방식을 고려해야겠음.

#### 😭 **Problem (문제점)**

- 현재 '모모코(인형극)' 아이디어는 '인형극'이 목적인지, '영상 제작'이 목적인지 포지션이 애매함
- "인형극을 하고 영상을 만든다"는 흐름 자체가 사용자에게 어색하게 다가갈 수 있으며, 목적성이 모호하게 느껴진다.
- 기획의 초점이 '어떻게 만들까'에 맞춰져 있어, 정작 사용자가 얻게 될 '명확한 결과물'과 '명확한 타겟층'이 부재한 상황
- 프로젝트 스케쥴(일정 관리 표)처럼 필수적이지만 놓치기 쉬운 문서들을 체계적으로 관리할 필요가 있음

#### 🤙 **Try (새로운 시도)**

- **다음에 시도할 방법**:
  - **문서화**: 요구사항 정의서, 프로그램 명세서, API 명세서, 프로젝트 스케쥴표 4가지는 필수적으로 작성하고, ERD는 DB복잡도를 고려해 생략 여부를 결정
  - **기획 구체화**: 아이디어의 방향성을 하나로 명확하게 구체화

---

### 🍅 임베디드(라즈베리파이) 환경을 위한 CI/CD 파이프라인 구축 구상

현재 팀에서 Gitlab → Jenkins → EC2(Docker)로 이어지는 CI/CD 파이프라인을 어떻게 구축할지 찾아보고 있다. 나아가, 이와 동일한 시스템을 라즈베리파이와 같은 임베디드 장비에도 적용하는 방안에 대해 조사하고 있다.

#### 도입 배경

1. **코드 관리의 어려움**: 라즈베리파이 장비 내에서 직접 코드를 수정하고 작업하면, 팀원 간의 코드 리뷰나 버전 관리가 사실상 불가능하다.
2. **데이터 유실 위험**: 다른 팀이 개발 도중 라즈베리파이 내부의 코드가 통째로 유실되어 곤란을 겪는 사례를 목격했었다. 모든 코드를 Gitlab과 같은 중앙 레포지토리에서 관리하면 이러한 휴먼 에러나 하드웨어 이슈로 인한 사고를 미연에 방지할 수 있지 않을까?

#### 고려했던 대안

처음에는 라즈베리파이에 Ubuntu OS를 설치하고, 지급받은 EC2 클라우드 서버에 NFS(Network File System)로 마운트하여 코드를 미러링하는 방식을 생각했다. 하지만 이 방법은 단순 파일 동기화일 뿐, 코드의 변경 이력을 추적하거나 협업을 진행하는데는 명확한 한계가 있다.

결론적으로 모든 코드는 **GitLab을 통해 형상 관리**를 하는 것이 정답이라고 판단했다.

---

#### 해결 방안 구상

GitLab 레포지토리에 코드를 push했을 때 WebHook을 통해 Jenkins가 알림을 받는 것까지는 기존 EC2 파이프라인 구상과 동일하다.

핵심 과제는 **Jenkins가 어떻게 원격의 라즈베리파이 장비에 코드를 배포하고 실행시킬 것인가?**이다.

여기에는 크게 3가지 접근 방식이 있을 수 있다.

##### 1. **SSH를 이용한 원격 배포(가장 간단하고 일반적인 방식)**

- **구성**: Jenkins 서버(EC2)가 라즈베리파이로 암호 없이 SSH 접속을 할 수 있도록 `SSH 키`를 등록한다.
- **파이프라인 단계(Jenkins)**:
  1. `git clone`: Jenkins 서버로 코드를 가져온다.
  2. `build`: (필요시) Jenkins 서버에서 코드를 빌드한다.
  3. `scp`: `scp` 명령어를 사용해 빌드된 결과물이나 배포 스크립트를 라즈베리파이로 복사한다.
  4. `ssh`: `ssh pi@<rpi-ip> "cd /home/pi/app && ./deploy.sh"`와 같이 원격 명령을 실행하여 라즈베리파이 내에서 배포 스크립트를 실행시킨다.
- **관련 플러그인**: `Publish Over SSH` 플러그인을 사용하면 이 과정을 파이프라인 스크립트에서 더 깔끔하게 관리할 수 있다.

##### 2. **라즈베리파이를 Jenkins Agent로 등록(RPi에서 직접 빌드)**

- **구성**: Jenkins Controller(마스터, EC2)에 라즈베리파이를 'Agent' 노드로 등록 → Jenkins가 SSH를 통해 RPi에 접속하여 Agent 프로세스를 실행시킴
- **장점**: 라즈베리파이의 고유한 환경(Ex. ARM 아키텍처)에서 직접 코드를 컴파일하고 테스트해야할 때 가장 이상적
- **단점**: 라즈베리파이의 리소스(CPU, 메모리)가 빌드 작업을 감당할 수 있어야 함

##### 3. **Docker를 이용한 배포**

- **구성**: 라즈베리파이에도 Docker를 설치
- **파이프라인 단계**:
  1. `git clone`
  2. **ARM용 Docker 이미지 빌드**: `docker buildx build --platform linux/arm/v7` (또는 v8/arm64) 명령을 통해 RPi의 ARM 아키텍처에 맞는 이미지를 빌드
  3. `docker push`: 빌드된 이미지를 Docker Hub나 GitLab Registry 등 접근 가능한 레지스트리에 푸시
  4. `ssh`: Jenkins가 1번 방식처럼 SSH로 RPi에 접속
  5. RPI에서 `docker pull`, `docker stop`, `docker rm`, `docker run` 명령어를 순차적으로 실행하여 새 버전의 컨테이너를 실행

이외 mqtt나 aws iot core에 대한 정보도 추가적으로 조사 해야할 것
