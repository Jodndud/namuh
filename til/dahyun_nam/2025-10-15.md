# Cookie vs. localStorage vs. sessionStorage

### Browser는 Cookie, localStorage, sessionStorage 이렇게 세 가지 종류의 저장소를 제공한다.

- 각 저장소에는 문자열 형태라면 어떤 정보든 저장할 수 있다.
- 단, Web 통신에 있어 가장 취약한 부분이기도 하기 때문에 탈취당했을 때 문제 생길 여지 있는 정보는 절대로 저장하면 안 된다.

### Storage의 주된 용도는 Client와 Server 사이에 형성된 session에 관한 정보, 즉 session ID 또는 token을 저장하는 것이다.

- HTTP 통신은 기본적으로 무상태(stateless)이다.
무상태란, 상태를 저장하지 않는다는 것이다.
- 한 번의 요청과 한 번의 응답이 끝나면 서로 어떠한 정보도 공유하지 않는다.
A가 로그인 후 페이지를 새로고침하면, 서버 입장에서는 '이 사람이 아까 그 사람인가?'를 모른다는 것이다.

### 그렇다면 로그인 상태 유지는 어떻게 가능할까?

- Server는 로그인 순간 session ID 또는 token을 생성해 사용자에게 준다.
- Client는 이걸 Storage에 보관하고, 다음 요청 때 함께 보낸다.
- Server는 session ID나 token을 보고 '아까 로그인한 사용자구나' 알아보는 것이다.

---

## localStorage

### localStorage의 저장소는 영구적이다.

- 삭제하지 않는 이상 정보가 유지된다.
컴퓨터를 껐다 켜도 로그인 상태가 유지된다.
- 브라우저를 새로고침하면 모든 일시적인 변수, 상태 값이 날아가기 때문에 새로고침하거나 브라우저를 껐다 켜도 유지돼야 하는 정보는 localStorage에 저장해야 한다.

## sessionStorage

### sessionStorage는 하나의 탭에서 유효하다.

- 탭을 닫으면 모든 정보가 삭제되고,
각각의 탭에 대해 sessionStorage가 존재한다.

## Cookie

### Client에 의해 관리되는 local/sessionStorage와 달리 Cookie는 대부분 Server에 의해 관리된다.

- Client 코드에서도 접근은 가능하다.

### Cookie는 Server의 Response Header에 아래와 같은 형태로 작성된다.

```
Set-Cookie: my_name=Lifthus; Expires=Sun, 07 Apr 2023 00:00:00 GMT; Domain=.example.com; Path=/; HttpOnly; Secure; SameSite=Lax
```

### 왜 'Set'-Cookie일까?

- 'Set-Cookie' Header는 그 자체로 저장소가 아니라,
말 그대로 이 Cookie들을 Set하라고 Server가 Browser에 내리는 명령이다.
- Browser는 해당 Header를 받으면 명령에 따라 Cookie 값을 저장하고,
페이지를 새로고침하거나 다른 페이지로 이동하는 등 같은 사이트에 다시 요청할 때마다
Browser가 저장해둔 Cookie를 'Cookie'라는 이름의 Header에 담아 자동으로 Server로 보낸다.